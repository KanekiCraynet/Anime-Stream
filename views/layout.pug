doctype html
html(lang="id" class="scroll-smooth")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title= title || "KitaNime - Streaming Anime Subtitle Indonesia"
    meta(name="description" content=description || "Nonton anime subtitle Indonesia terlengkap dan terbaru")
    meta(name="keywords" content="kitanime, KitaNime, anime, streaming anime, subtitle indonesia, nonton anime, anime sub indo, anime indonesia, streaming anime gratis, anime terbaru, anime ongoing, anime complete, anime movie, download anime, watch anime online, anime HD, otaku indonesia, Streaming Anime Sub Indo, streaming anime, sub indo, sub indonesia")
    
    meta(name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1")
    meta(name="google-site-verification" content="KYZb3rNH5REPdVtPCSei_EhvxVJDmX7zd1KVWn49M_k")
    meta(name="language" content="Indonesian")
    meta(http-equiv="content-language" content="id-ID")
    meta(name="author" content="IkuzaDev")
    meta(name="publisher" content="D5studioID")
    meta(name="copyright" content="© 2025 KitaNime. All rights reserved.")
    meta(name="google-adsense-account" content="ca-pub-7452678962186302")
    link(rel="icon" href="/images/favicon.ico" onerror="this.onerror=null;this.src='https://placehold.co/400';")
    link(rel="dns-prefetch" href="//d5studio.my.id")  
    link(rel="canonical" href="https://d5studio.my.id")
    link(rel="alternate" hreflang="id" href=`https://d5studio.my.id${url || '/'}`)
    link(rel="alternate" hreflang="x-default" href=`https://d5studio.my.id${url || '/'}`)
    link(rel="icon" type="image/x-icon" href="/images/favicon.ico")
    link(rel="icon" type="image/png" sizes="32x32" href="/images/logo.png")
    link(rel="icon" type="image/png" sizes="16x16" href="/images/logo.png")
    link(rel="apple-touch-icon" sizes="180x180" href="/images/logo.png")
    link(rel="robots" href="/robots.txt")
    link(rel="sitemap" type="application/xml" href="/sitemap.xml")

    meta(http-equiv="X-UA-Compatible" content="IE=edge")
    meta(name="format-detection" content="telephone=no")
    meta(name="theme-color" content="#8b5cf6")
    meta(name="msapplication-TileColor" content="#8b5cf6")

    link(rel="preconnect" href="https://fonts.googleapis.com")
    link(rel="preconnect" href="https://fonts.gstatic.com" crossorigin)
    link(rel="preconnect" href="https://cdn.plyr.io")
    link(rel="preconnect" href="https://cdn.tailwindcss.com")
    
    meta(property="og:title" content=title)
    meta(property="og:description" content=description)
    meta(property="og:type" content="website")
    meta(property="og:url" content="https://d5studio.my.id")
    meta(property="og:site_name" content="KitaNime")
    meta(property="og:image" content="https://d5studio.my.id/images/logo.png")
    
    meta(name="twitter:card" content="summary_large_image")
    meta(name="twitter:title" content=title)
    meta(name="twitter:description" content=description)
    meta(name="twitter:image" content="https://d5studio.my.id/images/logo.png")
    script(type="application/ld+json").
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "KitaNime",
        "alternateName": "KitaNime - Streaming Anime Sub Indo",
        "url": "https://d5studio.my.id",
        "description": "Platform streaming anime subtitle Indonesia terlengkap dan terbaru. Nikmati ribuan anime berkualitas tinggi dengan subtitle Indonesia.",
        "inLanguage": "id-ID",
        "publisher": {
          "@type": "Organization",
          "name": "KitaNime",
          "url": "https://d5studio.my.id",
          "logo": {
            "@type": "ImageObject",
            "url": "https://d5studio.my.id/images/logo.png",
            "width": 400,
            "height": 400
          }
        },
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://d5studio.my.id/search?q={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        },
        "sameAs": [
          "https://twitter.com/KitaNime",
          "https://facebook.com/KitaNime"
        ]
      }
    script(type="application/ld+json").
        {
          "@context": "https://schema.org",
          "@type": "Organization",
          "name": "KitaNime",
          "url": "https://d5studio.my.id",
          "logo": "https://d5studio.my.id/images/logo.png",
          "sameAs": [
              "https://www.facebook.com/rrq.ikz",
              "https://www.instagram.com/d5studio"
          ],
          "contactPoint": {
              "@type": "ContactPoint",
              "telephone": "+62-8578-1866-785",
              "contactType": "customer service",
              "areaServed": "ID"
          }
        }
    
    link(rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css")
    script(src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js")
    script(src='https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js')
    if process.env.NODE_ENV === 'production'
      script(async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7452678962186302" crossorigin="anonymous")
    if process.env.NODE_ENV !== 'production'
      script(src="https://cdn.tailwindcss.com/3.4.17")
    else
      link(rel="stylesheet" href="/css/tailwind.css")
    link(rel="stylesheet" href="/css/theme.css")
    script.
      if (typeof tailwind !== 'undefined') {
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: {
                50: '#f5f3ff',
                100: '#ede9fe',
                200: '#ddd6fe',
                300: '#c4b5fd',
                400: '#a78bfa',
                500: '#8b5cf6',
                600: '#7c3aed',
                700: '#6d28d9',
                800: '#5b21b6',
                900: '#4c1d95'
              }
            },
            fontFamily: {
              'sans': ['Inter', 'system-ui', 'sans-serif']
            }
          }
        }
      }
    
    style.
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
      
      .anime-card {
        transition: all 0.3s ease;
      }
      
      .anime-card:hover {
        transform: translateY(-4px);
      }
      
      .video-player {
        aspect-ratio: 16/9;
        background: #000;
      }
      
      .search-suggestions {
        max-height: 300px;
        overflow-y: auto;
      }
      
      .ad-slot {
        min-height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

  body(class="bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-gray-900 dark:via-slate-900 dark:to-indigo-900 text-gray-900 dark:text-gray-100 font-sans transition-all duration-500 min-h-screen")
    
    // Loading Screen
    div(id="loadingScreen" class="fixed inset-0 bg-gradient-to-br from-primary-600 via-purple-600 to-indigo-700 z-50 flex items-center justify-center transition-opacity duration-500")
      div(class="text-center")
        div(class="w-20 h-20 mx-auto mb-6 relative")
          div(class="absolute inset-0 border-4 border-white/20 rounded-full")
          div(class="absolute inset-0 border-4 border-white border-t-transparent rounded-full animate-spin")
        div(class="text-white text-xl font-semibold mb-2") KitaNime
        div(class="text-white/80 text-sm") Memuat konten terbaik untuk Anda...
    
    // Progress Bar
    div(id="progressBar" class="fixed top-0 left-0 w-full h-1 bg-primary-600 transform -translate-x-full transition-transform duration-300 z-50")
    header(class="bg-white/70 dark:bg-gray-900/70 backdrop-blur-xl border-b border-white/20 dark:border-gray-700/30 sticky top-0 z-50 transition-all duration-500 shadow-lg shadow-black/5 dark:shadow-black/20")
      nav(class="container mx-auto px-4 md:px-6 lg:px-8 py-4")
        div(class="flex items-center justify-between")
          // Logo Section
          a(href="/" class="flex items-center group")
            img(src="/images/logo.png" alt="KitaNime" class="h-10 w-auto rounded-lg shadow-md group-hover:shadow-lg transition-all duration-300", onerror="this.onerror=null;this.src='https://placehold.co/400?text=KN';")
            span(class="ml-3 text-xl font-bold bg-gradient-to-r from-primary-600 to-purple-600 bg-clip-text text-transparent hidden sm:block") KitaNime
          
          // Desktop Navigation
          div(class="hidden lg:flex items-center space-x-1")
            a(href="/" class=`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${currentPage === 'home' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 shadow-md' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Home
            a(href="/ongoing" class=`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${currentPage === 'ongoing' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 shadow-md' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Ongoing
            a(href="/complete" class=`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${currentPage === 'complete' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 shadow-md' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Complete
            a(href="/genres" class=`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${currentPage === 'genres' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 shadow-md' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Genre
            a(href="/movies" class=`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${currentPage === 'movies' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 shadow-md' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Movie
          
          // Search Bar
          div(class="flex-1 max-w-lg mx-4 lg:mx-8 relative")
            form(action="/search" method="GET" class="relative group")
              div(class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none")
                svg(class="w-5 h-5 text-gray-400 group-focus-within:text-primary-500 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                  path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z")
              input(
                type="text" 
                name="q" 
                placeholder="Cari anime favorit..." 
                value=keyword || ""
                class="w-full pl-12 pr-4 py-3 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 rounded-2xl text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500/50 focus:bg-white dark:focus:bg-gray-800 transition-all duration-300 shadow-sm hover:shadow-md"
                autocomplete="off"
                id="searchInput"
              )
            
            div(id="searchSuggestions" class="absolute top-full left-0 right-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border border-gray-200/50 dark:border-gray-700/50 rounded-2xl shadow-2xl mt-2 hidden search-suggestions z-50 overflow-hidden")
          
          // Right Side Actions
          div(class="flex items-center space-x-3")
            // Dark Mode Toggle
            button(id="darkModeToggle" class="p-3 rounded-xl bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 hover:bg-white/80 dark:hover:bg-gray-800/80 transition-all duration-300 shadow-sm hover:shadow-md group")
              svg(id="sunIcon" class="w-5 h-5 text-amber-500 dark:hidden group-hover:rotate-180 transition-transform duration-500" fill="currentColor" viewBox="0 0 20 20")
                path(fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd")
              svg(id="moonIcon" class="w-5 h-5 text-indigo-300 hidden dark:block group-hover:rotate-12 transition-transform duration-500" fill="currentColor" viewBox="0 0 20 20")
                path(d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z")
            
            // User Actions
            if currentUser
              a(href="/account" class="hidden md:inline-flex items-center px-4 py-2 rounded-xl bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 text-gray-700 dark:text-gray-200 hover:bg-white/80 dark:hover:bg-gray-800/80 transition-all duration-300 shadow-sm hover:shadow-md") 
                span Akun
              form(action="/auth/logout" method="POST" class="hidden md:inline-block")
                button(type="submit" class="ml-2 px-4 py-2 rounded-xl bg-gradient-to-r from-primary-600 to-purple-600 text-white hover:from-primary-700 hover:to-purple-700 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5") 
                  span Keluar
            else
              a(href="/auth/login" class="hidden md:inline-flex items-center px-4 py-2 rounded-xl bg-gradient-to-r from-primary-600 to-purple-600 text-white hover:from-primary-700 hover:to-purple-700 transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5") 
                span Masuk
            
            // Mobile Menu Button
            button(id="mobileMenuBtn" class="lg:hidden p-3 rounded-xl bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200/50 dark:border-gray-700/50 text-gray-600 dark:text-gray-300 hover:bg-white/80 dark:hover:bg-gray-800/80 transition-all duration-300 shadow-sm hover:shadow-md")
              svg(class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16")
        
        // Mobile Menu
        div(id="mobileMenu" class="lg:hidden hidden mt-4 pt-4 border-t border-gray-200/50 dark:border-gray-700/50")
          div(class="flex flex-col space-y-2")
            a(href="/" class=`px-4 py-3 rounded-xl font-medium transition-all duration-300 ${currentPage === 'home' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Beranda
            a(href="/ongoing" class=`px-4 py-3 rounded-xl font-medium transition-all duration-300 ${currentPage === 'ongoing' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Ongoing
            a(href="/complete" class=`px-4 py-3 rounded-xl font-medium transition-all duration-300 ${currentPage === 'complete' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Complete
            a(href="/genres" class=`px-4 py-3 rounded-xl font-medium transition-all duration-300 ${currentPage === 'genres' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Genre
            a(href="/movies" class=`px-4 py-3 rounded-xl font-medium transition-all duration-300 ${currentPage === 'movies' ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300' : 'text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400'}`) 
              span Movies
            if currentUser
              a(href="/account" class="px-4 py-3 rounded-xl font-medium text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-300") 
                span Akun
              form(action="/auth/logout" method="POST")
                button(type="submit" class="mt-2 w-full px-4 py-3 rounded-xl bg-gradient-to-r from-primary-600 to-purple-600 text-white hover:from-primary-700 hover:to-purple-700 transition-all duration-300") 
                  span Keluar
            else
              a(href="/auth/login" class="px-4 py-3 rounded-xl font-medium text-gray-600 dark:text-gray-300 hover:bg-white/50 dark:hover:bg-gray-800/50 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-300") 
                span Masuk

    if adSlots && adSlots.header && adSlots.header.length > 0
      div(class="container mx-auto px-4 py-2")
        each ad in adSlots.header
          div(class="ad-slot bg-gray-100 rounded-lg")!= ad.content

    main(class="min-h-screen")
      block content

    footer(class="bg-gradient-to-br from-gray-900 via-slate-900 to-indigo-900 dark:from-gray-950 dark:via-slate-950 dark:to-indigo-950 text-white mt-16 transition-all duration-500 relative overflow-hidden")
      // Background decoration
      div(class="absolute inset-0 bg-gradient-to-r from-primary-600/10 via-purple-600/10 to-indigo-600/10")
      div(class="absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-primary-500/50 to-transparent")
      
      div(class="container mx-auto px-4 md:px-6 lg:px-8 py-12 relative")
        div(class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8")
          // Brand Section
          div(class="lg:col-span-2")
            div(class="flex items-center space-x-3 mb-6")
              img(src="/images/logo.png" alt="KitaNime" class="h-10 w-auto rounded-lg shadow-lg" onerror="this.onerror=null;this.src='https://placehold.co/400?text=KN';")
              span(class="text-2xl font-bold bg-gradient-to-r from-primary-400 to-purple-400 bg-clip-text text-transparent") KitaNime
            p(class="text-gray-300 mb-6 leading-relaxed max-w-md") Platform streaming anime subtitle Indonesia terlengkap dan terbaru. Nikmati ribuan anime berkualitas tinggi dengan subtitle Indonesia yang akurat dan berkualitas.
            div(class="flex space-x-4")
              a(href="#" class="p-3 rounded-xl bg-white/10 backdrop-blur-sm border border-white/20 hover:bg-white/20 hover:border-white/30 transition-all duration-300 group")
                svg(class="w-5 h-5 text-gray-300 group-hover:text-white transition-colors duration-300" fill="currentColor" viewBox="0 0 24 24")
                  path(d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z")
              a(href="#" class="p-3 rounded-xl bg-white/10 backdrop-blur-sm border border-white/20 hover:bg-white/20 hover:border-white/30 transition-all duration-300 group")
                svg(class="w-5 h-5 text-gray-300 group-hover:text-white transition-colors duration-300" fill="currentColor" viewBox="0 0 24 24")
                  path(d="M22.46 6c-.77.35-1.6.58-2.46.69.88-.53 1.56-1.37 1.88-2.38-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21 16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56.84-.6 1.56-1.36 2.14-2.23z")
          
          // Quick Links
          div
            h3(class="text-lg font-semibold mb-4 text-white") Menu Cepat
            ul(class="space-y-3")
              li
                a(href="/ongoing" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z")
                  span Anime Ongoing
              li
                a(href="/complete" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z")
                  span Anime Complete
              li
                a(href="/genres" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.99 1.99 0 013 12V7a4 4 0 014-4z")
                  span Genre Anime
              li
                a(href="/movies" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z")
                  span Film Anime
          
          // Support
          div
            h3(class="text-lg font-semibold mb-4 text-white") Dukungan
            ul(class="space-y-3")
              li
                a(href="/search" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z")
                  span Pencarian
              li
                a(href="/help" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")
                  span Bantuan
              li
                a(href="/contact" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z")
                  span Kontak
              li
                a(href="/about" class="text-gray-300 hover:text-primary-400 transition-colors duration-300 flex items-center group")
                  svg(class="w-4 h-4 mr-2 group-hover:translate-x-1 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z")
                  span Tentang Kami
      
      // Bottom Bar
      div(class="border-t border-white/10 py-6")
        div(class="container mx-auto px-4 md:px-6 lg:px-8")
          div(class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0")
            p(class="text-gray-400 text-sm") © 2025 KitaNime. All rights reserved. Made with ❤️ for anime lovers.
            div(class="flex items-center space-x-6 text-sm text-gray-400")
              a(href="/terms-of-service" class="hover:text-white transition-colors duration-300") Terms of Service
              a(href="/privacy-policy" class="hover:text-white transition-colors duration-300") Privacy Policy
              a(href="/dmca" class="hover:text-white transition-colors duration-300") DMCA

    // Scroll to Top Button
    button(id="scrollToTop" class="fixed bottom-6 right-6 w-12 h-12 bg-gradient-to-r from-primary-600 to-purple-600 text-white rounded-full shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 z-40 opacity-0 invisible")
      svg(class="w-6 h-6 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24")
        path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18")

    if showCookieConsent
      div(id="cookieConsent" class="fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-sm bg-white border border-gray-200 rounded-lg shadow-lg p-4 z-50")
        div(class="flex items-start space-x-3")
          div(class="flex-shrink-0")
            svg(class="w-5 h-5 text-primary-600 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24")
              path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")
          div(class="flex-1")
            p(class="text-sm text-gray-600 mb-3") Website ini menggunakan cookie untuk meningkatkan pengalaman browsing Anda.
            div(class="flex space-x-2")
              button(id="acceptCookies" class="px-3 py-1 bg-primary-600 text-white text-sm rounded hover:bg-primary-700 transition-colors") Terima
              button(id="declineCookies" class="px-3 py-1 bg-gray-200 text-gray-700 text-sm rounded hover:bg-gray-300 transition-colors") Tolak

    script.
      const darkModeToggle = document.getElementById('darkModeToggle');
      const html = document.documentElement;
      
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        html.classList.add('dark');
      }
      
      darkModeToggle?.addEventListener('click', function() {
        html.classList.toggle('dark');
        localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
        
        // Add animation effect
        this.style.transform = 'scale(0.95)';
        setTimeout(() => {
          this.style.transform = 'scale(1)';
        }, 150);
      });

      document.getElementById('mobileMenuBtn')?.addEventListener('click', function() {
        const menu = document.getElementById('mobileMenu');
        menu.classList.toggle('hidden');
      });

      const searchInput = document.getElementById('searchInput');
      const searchSuggestions = document.getElementById('searchSuggestions');
      let searchTimeout;

      searchInput?.addEventListener('input', function() {
        const query = this.value.trim();
        
        clearTimeout(searchTimeout);
        
        if (query.length < 2) {
          searchSuggestions.classList.add('hidden');
          return;
        }
        
        searchTimeout = setTimeout(() => {
          fetch(`/api/search/suggestions?q=${encodeURIComponent(query)}`)
            .then(response => response.json())
            .then(data => {
              if (data.suggestions && data.suggestions.length > 0) {
                searchSuggestions.innerHTML = data.suggestions.map(anime => 
                  `<a href="/anime/${anime.slug}" class="flex items-center space-x-3 p-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0">
                    <img src="${anime.poster}" alt="${anime.title}" class="w-10 h-14 object-cover rounded" onerror="this.onerror=null;this.src='https://placehold.co/400x560?text=No+Image';">
                    <span class="text-sm font-medium text-gray-900">${anime.title}</span>
                  </a>`
                ).join('');
                searchSuggestions.classList.remove('hidden');
              } else {
                searchSuggestions.classList.add('hidden');
              }
            })
            .catch(() => {
              searchSuggestions.classList.add('hidden');
            });
        }, 300);
      });

      document.addEventListener('click', function(e) {
        if (!searchInput?.contains(e.target) && !searchSuggestions?.contains(e.target)) {
          searchSuggestions?.classList.add('hidden');
        }
      });

      document.getElementById('acceptCookies')?.addEventListener('click', function() {
        fetch('/cookie-consent', { method: 'POST' })
          .then(() => {
            document.getElementById('cookieConsent').style.display = 'none';
          });
      });

      document.getElementById('declineCookies')?.addEventListener('click', function() {
        document.getElementById('cookieConsent').style.display = 'none';
      });

      // Scroll to Top Button functionality is handled below

      // Loading Screen and Progress Bar
      const loadingScreen = document.getElementById('loadingScreen');
      const progressBar = document.getElementById('progressBar');
      
      // Simulate loading progress
      let progress = 0;
      const loadingInterval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress >= 100) {
          progress = 100;
          clearInterval(loadingInterval);
          
          // Hide loading screen
          setTimeout(() => {
            loadingScreen.style.opacity = '0';
            setTimeout(() => {
              loadingScreen.style.display = 'none';
            }, 500);
          }, 300);
        }
        
        progressBar.style.transform = `translateX(-${100 - progress}%)`;
      }, 100);

      // Hide loading screen when page is fully loaded
      window.addEventListener('load', function() {
        document.body.classList.add('loaded');
        clearInterval(loadingInterval);
        progressBar.style.transform = 'translateX(0)';
        
        setTimeout(() => {
          loadingScreen.style.opacity = '0';
          setTimeout(() => {
            loadingScreen.style.display = 'none';
            progressBar.style.display = 'none';
          }, 500);
        }, 300);
      });

      // Intersection Observer for animations
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-fade-in-up');
          }
        });
      }, observerOptions);

      // Observe all anime cards
      document.querySelectorAll('.anime-card').forEach(card => {
        observer.observe(card);
      });

      // Toast Notification System
      function showToast(message, type = 'info', duration = 3000) {
        const toast = document.createElement('div');
        const icons = {
          success: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`,
          error: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`,
          warning: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg>`,
          info: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`
        };
        
        const colors = {
          success: 'bg-green-500',
          error: 'bg-red-500',
          warning: 'bg-yellow-500',
          info: 'bg-blue-500'
        };
        
        toast.className = `fixed top-4 right-4 ${colors[type]} text-white px-6 py-4 rounded-xl shadow-lg transform translate-x-full transition-transform duration-300 z-50 flex items-center space-x-3`;
        toast.innerHTML = `
          <div class="flex-shrink-0">${icons[type]}</div>
          <div class="flex-1">${message}</div>
          <button class="flex-shrink-0 ml-2 text-white/80 hover:text-white" onclick="this.parentElement.remove()">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        `;
        
        document.body.appendChild(toast);
        
        // Animate in
        setTimeout(() => {
          toast.style.transform = 'translateX(0)';
        }, 100);
        
        // Auto remove
        setTimeout(() => {
          toast.style.transform = 'translateX(100%)';
          setTimeout(() => {
            toast.remove();
          }, 300);
        }, duration);
      }

      // Global toast function
      window.showToast = showToast;

      // Bookmark functionality
      function toggleBookmark(animeId, animeTitle, animeSlug, posterUrl) {
        const isBookmarked = document.querySelector(`[data-anime-id="${animeId}"] .bookmark-btn`)?.classList.contains('bookmarked');
        
        fetch('/bookmarks/' + (isBookmarked ? 'remove' : 'add'), {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            animeId: animeId,
            animeTitle: animeTitle,
            animeSlug: animeSlug,
            posterUrl: posterUrl
          })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            const bookmarkBtn = document.querySelector(`[data-anime-id="${animeId}"] .bookmark-btn`);
            if (bookmarkBtn) {
              bookmarkBtn.classList.toggle('bookmarked');
              const icon = bookmarkBtn.querySelector('svg');
              if (isBookmarked) {
                icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>`;
                showToast('Dihapus dari bookmark', 'info');
              } else {
                icon.innerHTML = `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" fill="currentColor"></path>`;
                showToast('Ditambahkan ke bookmark', 'success');
              }
            }
          } else {
            showToast('Gagal mengupdate bookmark', 'error');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          showToast('Terjadi kesalahan', 'error');
        });
      }

      // Global bookmark function
      window.toggleBookmark = toggleBookmark;

      // Add event listeners for bookmark buttons
      document.addEventListener('click', function(e) {
        if (e.target.closest('.bookmark-btn')) {
          e.preventDefault();
          const button = e.target.closest('.bookmark-btn');
          const animeId = button.dataset.animeId;
          const animeTitle = button.dataset.animeTitle;
          const animeSlug = button.dataset.animeSlug;
          const animePoster = button.dataset.animePoster;
          
          if (animeId && animeTitle && animeSlug && animePoster) {
            toggleBookmark(animeId, animeTitle, animeSlug, animePoster);
          }
        }
      });

      // Scroll to top functionality
      const scrollToTopBtn = document.getElementById('scrollToTop');
      
      // Show/hide scroll to top button based on scroll position
      window.addEventListener('scroll', function() {
        if (window.pageYOffset > 300) {
          scrollToTopBtn.classList.remove('opacity-0', 'invisible');
          scrollToTopBtn.classList.add('opacity-100', 'visible');
        } else {
          scrollToTopBtn.classList.add('opacity-0', 'invisible');
          scrollToTopBtn.classList.remove('opacity-100', 'visible');
        }
      });
      
      // Scroll to top when button is clicked
      scrollToTopBtn.addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });

    script(src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js")
    
    if adsenseEnabled
      script(async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-xxxxxxxxxx" crossorigin="anonymous")
      script.
        (adsbygoogle = window.adsbygoogle || []).push({});

  block scripts
